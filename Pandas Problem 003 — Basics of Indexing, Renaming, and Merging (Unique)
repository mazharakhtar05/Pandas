#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Pandas Problem 003 — Basics of Indexing, Renaming, and Merging (Unique)

You are given two CSVs:
1) sales.csv
   Columns: sale_id, product_id, date, quantity, unit_price
2) products.csv
   Columns: product_id, product_name, category

Tasks (BASICS)
---------------
1) Generate synthetic CSVs and load them.
2) Basic inspection:
   - Show shape, head(3), info().
   - Rename columns to Title Case (e.g., 'Sale ID', 'Product ID').
3) Indexing & Selection:
   - Set 'Sale ID' as the index.
   - Show first 5 rows with only ['Product ID', 'Quantity'].
   - Reset index back.
4) Derived Columns:
   - Compute `Revenue = Quantity * Unit Price`.
   - Extract `Month` from `Date`.
5) Merge:
   - Merge with products.csv on Product ID.
   - Keep only ['Date', 'Product Name', 'Category', 'Quantity', 'Unit Price', 'Revenue'].
6) Grouping:
   - Total revenue by Category.
   - Average revenue by Month.
7) Sorting:
   - Sort merged table by Revenue (descending) and show top 5 rows.
8) Reshaping (Intro):
   - Create a pivot table: index=Category, columns=Month, values=Revenue (sum), fill_value=0.
9) Save Artifacts:
   - Clean merged table → ./artifacts/sales_clean.csv
   - Category revenue summary → ./artifacts/category_revenue.csv
   - Monthly average revenue → ./artifacts/monthly_avg_revenue.csv
   - Pivot → ./artifa
